<style>body{margin:0;background:#000}canvas{height:100vmin;width:100vmin}</style><canvas></canvas><script>function a(){function a(){let a=k.innerWidth,c=k.innerHeight;b.width=a,b.height=c,n.viewport(0,0,a,c)}let b=l.querySelector('canvas');return n=b.getContext('webgl'),k.onresize=a,a(),n.clearColor(0,0,0,1),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),n.enable(n.BLEND),n}function b(a,b){let c=n.createShader(a?n.FRAGMENT_SHADER:n.VERTEX_SHADER);return n.shaderSource(c,b),n.compileShader(c),c}function c(a,b,d=1,e=0){let f=Math.cos(e),c=i(e);return new Float32Array([f*d,c*d,0,0,-c*d,f*d,0,0,0,0,1,0,a,b,0,1])}function d(a,b){let c=1e4*i(t++);return m((c-m(c))*(b-a)+a)}function e(a){return a.splice(d(0,a.length),1)[0]}function f(a){let b=0;for(let c of a.children){let d=a.position[0]-c.position[0],e=a.position[1]-c.position[1];b+=1==d?A:-1==d?B:1==e?C:D}return b}function g(){let[a,b]=[H.x,H.y];let c=H.x,d=H.y,e=G.grid.get(j(c),j(d));if(I.w&&(b-=w),I.s&&(b+=w),I.a&&(a-=w),I.d&&(a+=w),j(a)!==j(c)){let b=G.grid.get(j(a),j(d));-1!==e.children.indexOf(b)&&(H.x=a)}else H.x=a;if(j(b)!==j(d)){let a=G.grid.get(j(c),j(b));-1!==e.children.indexOf(a)&&(H.y=b)}else H.y=b;e.touched=!1,e.time||(e.time=Date.now())}function h(){let a=F.gl;a.clear(a.COLOR_BUFFER_BIT),g();let b=12;F.camera=new Float32Array([b,0,0,0,0,b,0,0,0,0,1,0,-b*H.x,-b*H.y,1,1]),G.draw(),H.draw(),k.requestAnimationFrame(h)}var i=Math.sin,j=Math.floor;let k=window,l=document,m=j;let n,o,p='precision mediump float;attribute vec2 h;uniform mat4 l,i,j;varying vec2 b;void main(){gl_Position=j*i*l*vec4(h,0,1),b=h;}',q={modelMat:'l',viewMat:'i',projMat:'j',squareType:'d',squareState:'f',t:'k'},r={vertPos:'h'};class s{constructor(a,...c){this.renderer=a;let d=this.shaderProgram=o.createProgram();for(let e=0;2>e;e+=1)o.attachShader(d,b(e,c[e]));for(let b in o.linkProgram(d),this.use(),q)this[b]=o.getUniformLocation(d,q[b]);for(let b in r)this[b]=o.getAttribLocation(d,r[b]),o.enableVertexAttribArray(this[b])}use(){this.renderer.use(this)}}let t=j(1e4*Math.random());let u=20,v=20,w=0.04;class z{constructor(a,b){this.untouched=[],this.children=[],this.touched=!1,this.length=0,this.time=0,this.position=[a,b]}}class x{get(a,b){let c=[a,b].toString();if(a>=u||b>=v||0>a||0>b)return null;let d=this[c];return d||(d=this[c]=new z(a,b)),d}}var y=function(){let a=new x,b=[[-1,0],[1,0],[0,-1],[0,1]];for(let c=0;c<u;c++)for(let d=0;d<v;d++){let e=a.get(c,d);for(let f of b){let b=a.get(c+f[0],d+f[1]);b&&e.untouched.push(b)}}let c=a.get(d(0,u),d(0,v)),f=[c];let g=c;for(;f.length;){let a=f[0];if(a.touched=!0,!a.untouched.length){f.shift();continue}let b=e(a.untouched);b.touched||(b.untouched.splice(b.untouched.indexOf(a),1),b.children.push(a),b.length=a.length+1,b.length>g.length&&(g=b),a.children.push(b),b.touched=!0,f.splice(0,0,b))}return[a,c,g]};let A=1,B=2,C=4,D=8;let E=0.4;l.title='Lst';let F=new class{constructor(){this.camera=c(-8,-8,0.85,0),this.gl=o=a(),this.squareBuffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.squareBuffer),o.bufferData(o.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),o.STATIC_DRAW)}use(a){this.currentProgram=a,o.useProgram(a.shaderProgram)}setMatrices(){let a=-10,b=10,c=10,d=-10,e=1/(a-b),f=1/(c-d);o.uniformMatrix4fv(this.currentProgram.viewMat,!1,this.camera),o.uniformMatrix4fv(this.currentProgram.modelMat,!1,this.modelMat),o.uniformMatrix4fv(this.currentProgram.projMat,!1,new Float32Array([-2*e,0,0,0,0,-2*f,0,0,0,0,2*(1/-160),0,(a+b)*e,(d+c)*f,0,1]))}},G=new class{constructor(a){this.renderer=a,[this.grid,this.start,this.end]=y(),this.program=new s(a,p,'precision mediump float;uniform ivec4 d;uniform int f;uniform float k;varying vec2 b;float g(float a){return 1.-a*a*a;}void main(){vec4 c=vec4(0,0,0,1),e=vec4(1,1,1,1);e=f==0?vec4(0,.5,0,1):f==1?vec4(.5,0,0,1):f==2?vec4(.5,.5,.5,1):e;vec4 a=mix(vec4(.5,.5,.5,1),e,1.-g(f<2?1.:k));a=d.x==0&&b.x<.01?c:a,a=d.z==0&&b.x>.99?c:a,a=d.y==0&&b.y<.01?c:a,a=d.w==0&&b.y>.99?c:a,gl_FragColor=a;}')}draw(){this.program.use();let a=this.renderer.gl;a.bindBuffer(a.ARRAY_BUFFER,this.renderer.squareBuffer),a.vertexAttribPointer(this.program.vertPos,2,a.FLOAT,!1,0,0);for(let b=0;b<u;b+=1)for(let d=0;d<v;d+=1){this.renderer.modelMat=c(b,d),this.renderer.setMatrices();let e=this.grid.get(b,d),g=f(e);a.uniform1i(this.program.squareState,e===this.start?0:e===this.end?1:e.touched?2:3);let h=e.time?(Date.now()-e.time)/350:0;1<h&&(h=1),a.uniform1f(this.program.t,h),a.uniform4iv(this.program.squareType,[A&g,C&g,B&g,D&g]),a.drawArrays(a.TRIANGLE_STRIP,0,4)}}}(F),H=new class{constructor(a,b){this.renderer=a,this.maze=b,[this.x,this.y]=[b.start.position[0]+0.5,b.start.position[1]+0.5],this.program=new s(a,p,'precision mediump float;varying vec2 b;float g(float a){return 1.-a*a*a;}void main(){vec2 a=b-.5;float c=g(distance(vec2(0,0),a/.1));gl_FragColor=vec4(1,0,0,c);}')}draw(){this.program.use();let a=this.renderer.gl;a.bindBuffer(a.ARRAY_BUFFER,this.renderer.squareBuffer),a.vertexAttribPointer(this.program.vertPos,2,a.FLOAT,!1,0,0),this.renderer.modelMat=c(this.x-E/2,this.y-E/2,E),this.renderer.setMatrices(),a.drawArrays(a.TRIANGLE_STRIP,0,4)}}(F,G),I={};onkeydown=(a)=>{I[a.key.toLowerCase()]=1},onkeyup=(a)=>{I[a.key.toLowerCase()]=0},h()</script>